<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Planillaje Vehicular</title>

<style>
body{
font-family: Arial;
background:#f4f6f9;
padding:20px;
}
h2{
text-align:center;
}
label{
font-weight:bold;
display:block;
margin-top:10px;
}
input,select,textarea,button{
width:100%;
padding:10px;
margin-top:5px;
border-radius:6px;
border:1px solid #ccc;
font-size:16px;
}
button{
background:#007BFF;
color:white;
border:none;
margin-top:15px;
font-size:18px;
}
button:hover{
background:#0056b3;
}
</style>
</head>
<body>

<h2>Planillaje de Ingreso Vehicular</h2>

<label>Fecha</label>
<input type="date" id="fecha">

<label>Conjunto</label>
<select id="conjunto">
<option>Quintas del Portal</option>
<option>San Rafael</option>
<option>Virrey</option>
<option>Bosques de los Comuneros</option>
<option>Corinto</option>
<option>Torrecampo</option>
<option>Nueva Castilla</option>
<option>Faisanes</option>
<option>Casas 3</option>
<option>Alameda</option>
<option>Brisas</option>
<option>Fortaleza</option>
</select>

<label>Placa</label>
<input type="text" id="placa">

<label>Propietario</label>
<input type="text" id="propietario">

<label>Celular</label>
<input type="text" id="celular">

<label>Hora Ingreso</label>
<input type="time" id="hora_ingreso">

<label>Hora Salida</label>
<input type="time" id="hora_salida">

<label>Visitante</label>
<select id="visitante">
<option>No</option>
<option>Si</option>
</select>

<label>Turno</label>
<select id="turno">
<option>Diurno</option>
<option>Nocturno</option>
</select>

<label>Nombre del Guarda</label>
<input type="text" id="guarda">

<label>Novedades</label>
<textarea id="novedades"></textarea>

<button onclick="enviar()">Enviar Planillaje</button>

<script>

const WEBHOOK_URL = "https://script.google.com/macros/s/AKfycbwKDoWIDplE_II9CIJ10o6LN7r_fxFPjIZmuKixDuBdJEVHXEQKnI7u0HlTtBwBvv1d/exec";

function calcularTiempo(ingreso, salida){
if(!ingreso || !salida) return "";

const [h1,m1] = ingreso.split(":").map(Number);
const [h2,m2] = salida.split(":").map(Number);

let minutos1 = h1*60 + m1;
let minutos2 = h2*60 + m2;

if(minutos2 < minutos1){
minutos2 += 24*60;
}

let total = minutos2 - minutos1;
let horas = Math.floor(total/60);
let minutos = total%60;

return horas+"h "+minutos+"m";
}

function enviar(){

const fecha = document.getElementById("fecha").value;
const conjunto = document.getElementById("conjunto").value;
const placa = document.getElementById("placa").value;
const propietario = document.getElementById("propietario").value;
const celular = document.getElementById("celular").value;
const hora_ingreso = document.getElementById("hora_ingreso").value;
const hora_salida = document.getElementById("hora_salida").value;
const visitante = document.getElementById("visitante").value;
const turno = document.getElementById("turno").value;
const guarda = document.getElementById("guarda").value;
const novedades = document.getElementById("novedades").value;

const tiempo_total = calcularTiempo(hora_ingreso, hora_salida);

const datos = {
fecha,
conjunto,
placa,
propietario,
celular,
hora_ingreso,
hora_salida,
tiempo_total,
visitante,
turno,
guarda,
novedades
};

fetch(WEBHOOK_URL,{
method:"POST",
body:JSON.stringify(datos),
headers:{"Content-Type":"application/json"}
})
.then(res=>res.json())
.then(res=>{
if(res.status==="ok"){
alert("✅ Planillaje enviado correctamente");
location.reload();
}else{
alert("❌ Error al guardar");
}
})
.catch(()=>{
alert("❌ Error de conexión");
});

}

</script>

</body>
</html>
